COMPILE;
DIRECTORY MASTER;
/****************************************************************************
blit
19/10/88

Top level of the blitter module

****************************************************************************/


MODULE BLIT;

INPUTS	A_0,A_1,A_2,A_3,A_4,A_5,A_6,A_7,A_8,A_9,A_10,A_11,A_12,A_13,A_14,A_15,
   A_16,A_17,A_18,A_19,D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,D_8,D_9,D_10,D_11,D_12,
   D_13,D_14,D_15,RESETL,HLDAL,DSPBRQL,INTL,IORDL,IOWRL,BCSL,CCLK,WAITL;
OUTPUTS	A_0,A_1,A_2,A_3,A_4,A_5,A_6,A_7,A_8,A_9,A_10,A_11,A_12,A_13,A_14,A_15,
   A_16,A_17,A_18,A_19,D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,D_8,D_9,D_10,D_11,D_12,
   D_13,D_14,D_15,BMREQ,BRD,BWR,BWORD,DSPBAKL,BHOLDL,TESTWRL;
LEVEL FUNCTION;
DEFINE

/* The data path */

DATA_(D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,D_8,D_9,D_10,D_11,D_12,D_13,D_14,D_15,
   INHIB) = DATA(D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,D_8,D_9,D_10,D_11,D_12,D_13,
   D_14,D_15,DAM1L,DATOEL,DSTCMP,ICNT_0,ICNT_1,ICNT_2,ID_0,ID_1,ID_2,ID_3,ID_4,
   ID_5,ID_6,ID_7,ID_8,ID_9,ID_10,ID_11,ID_12,ID_13,ID_14,ID_15,LDCMPL,LDDSTL,
   LDPATL,LDMODL,LDSRCL,RES_0,SSWAP,SRCCMP,SRCLTOH);

/* The address generator */

ADDR_(A_0,A_1,A_2,A_3,A_4,A_5,A_6,A_7,A_8,A_9,A_10,A_11,A_12,A_13,A_14,A_15,
   A_16,A_17,A_18,A_19,D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,BORROW,DAM1L,DSTCMP,
   SAM1L,SRCCMP) = ADDR(A_0,A_1,A_2,A_3,A_4,A_5,A_6,A_7,A_8,A_9,A_10,A_11,A_12,
   A_13,A_14,A_15,A_16,A_17,A_18,A_19,D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,ADDBACKL,
   ADDBLDL,ADSTP,BUSOE,SRCENF,DSTRDL_0,DSTRDL_1,DSTRDL_2,ID_0,ID_1,ID_2,ID_3,
   ID_4,ID_5,ID_6,ID_7,LDDAL_0,LDDAL_1,LDDAL_2,LDSAL_0,LDSAL_1,LDSAL_2,LDSTPL,
   LDMODL,LINDR,PCEN,PCWRL_0,PCWRL_1,PCWRL_2,RES_0,RES_1,RUN,SDASEL,SRCRD,
   SRCRDL_0,SRCRDL_1,SRCRDL_2,UPDDSTL,UPDPCL,UPDSRCL,UPSLDL);

/* The state machine and control logic */

STATE_(D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,ADDBACKL,ADDBLDL,ADSTP,DATOEL,ICNT_0,
   ICNT_1,ICNT_2,INCYCL,LDCMPL,LDDAL_0,LDDAL_1,LDDAL_2,LDDSTL,LDMODL,LDPATL,
   LDSAL_0,LDSAL_1,LDSAL_2,LDSRCL,LDSTPL,LINDR,PCEN,RES_0,RES_1,RUN,SDASEL,
   SRCENF,SRCLTOH,SRCRD,SSWAP,STOP,UPDDSTL,UPDPCL,UPDSRCL,UPSLDL,BMREQ,BRD,BWR,
   BWORD) = STATE(D_0,D_1,D_2,D_3,D_4,D_5,D_6,D_7,ACKINT,BORROW,CCLK,CMDWRL,
   CONWRL,DAM1L,ID_0,ID_1,ID_2,ID_3,ID_4,ID_5,ID_6,ID_7,INCRDL,INHIB,OUTCRDL,
   RESET,SAM1L,STRD,WAITL);

/* The bus control and decode logic */

BUSCON_(D_0,D_3,D_4,D_5,D_6,D_7,ACKINT,BHOLDL,BUSOE,CMDWRL,CONWRL,DSPBAKL,
   DSTRDL_0,DSTRDL_1,DSTRDL_2,INCRDL,OUTCRDL,PCWRL_0,PCWRL_1,PCWRL_2,SRCRDL_0,
   SRCRDL_1,SRCRDL_2,STRD,TESTWRL) = BUSCON(D_0,D_3,D_4,D_5,D_6,D_7,A_0,A_1,A_2,
   A_3,A_4,BCSL,HLDAL,DSPBRQL,ID_0,INTL,IORDL,IOWRL,INCYCL,RESET,RUN,STOP);

/* Locally invert some inputs, and buffer to keep fanouts down */

RESETINV_(RESET) = N1B(RESETL);
DBUF_0_(ID_0) = B3A(D_0);
DBUF_1_(ID_1) = B3A(D_1);
DBUF_2_(ID_2) = B3A(D_2);
DBUF_3_(ID_3) = B3A(D_3);
DBUF_4_(ID_4) = B3A(D_4);
DBUF_5_(ID_5) = B3A(D_5);
DBUF_6_(ID_6) = B3A(D_6);
DBUF_7_(ID_7) = B3A(D_7);
DBUF_8_(ID_8) = B3A(D_8);
DBUF_9_(ID_9) = B3A(D_9);
DBUF_10_(ID_10) = B3A(D_10);
DBUF_11_(ID_11) = B3A(D_11);
DBUF_12_(ID_12) = B3A(D_12);
DBUF_13_(ID_13) = B3A(D_13);
DBUF_14_(ID_14) = B3A(D_14);
DBUF_15_(ID_15) = B3A(D_15);

END MODULE;

END COMPILE;
END;
